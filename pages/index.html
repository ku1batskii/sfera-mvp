<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sfera — главная</title>
    <link rel="stylesheet" href="../styles/main.css" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sfera — главная</title>
    <link rel="stylesheet" href="../styles/main.css" />
    <link rel="stylesheet" href="../styles/components.css" />
    <link rel="stylesheet" href="styles/main.css" />
    <link rel="stylesheet" href="styles/theme.css" />
    <link rel="stylesheet" href="styles/card.css" />
  </head>
  <body>
    <header class="header">
      <h1 class="logo">Sfera</h1>
    </header>

    <section class="hero">
      <img
        src="https://images.pexels.com/photos/1190298/pexels-photo-1190298.jpeg"
        alt="Hero Banner"
        class="hero-img"
      />

      <div class="hero-text">
        <h2>Добро пожаловать в Sfera</h2>
        <p>
          Смотрите события в вашем городе и находите компанию для посещения!
        </p>
      </div>
    </section>

    <section class="home-actions">
      <a href="events-list.html" class="btn">Список мероприятий</a>
      <a href="map.html" class="btn">Открыть карту</a>
    </section>

    <!-- Telegram-style event cards preview -->
    <section class="events-preview tg-cards" aria-label="События">
      <a class="tg-card" href="event-details.html">
        <div class="tg-card-banner" aria-hidden="true">
          <img
            src="https://images.pexels.com/photos/167636/pexels-photo-167636.jpeg"
            alt="Концерт"
          />
        </div>
        <div class="tg-card-body">
          <h3 class="tg-card-title">Ночной концерт</h3>
          <p class="tg-card-desc">
            Живая музыка, местные группы и уютная атмосфера.
          </p>
          <span class="tg-card-time">Сегодня, 21:00</span>
        </div>
      </a>

      <a class="tg-card" href="event-details.html">
        <div class="tg-card-banner" aria-hidden="true">
          <img
            src="https://images.pexels.com/photos/109919/pexels-photo-109919.jpeg"
            alt="Творческий мастер-класс"
          />
        </div>
        <div class="tg-card-body">
          <h3 class="tg-card-title">Мастер‑класс по рисованию</h3>
          <p class="tg-card-desc">
            Научитесь новым техникам и возьмите домой собственную работу.
          </p>
          <span class="tg-card-time">Завтра, 15:00</span>
        </div>
      </a>

      <a class="tg-card" href="event-details.html">
        <div class="tg-card-banner" aria-hidden="true">
          <img
            src="https://images.pexels.com/photos/356043/pexels-photo-356043.jpeg"
            alt="Выставка"
          />
        </div>
        <div class="tg-card-body">
          <h3 class="tg-card-title">Арт‑выставка города</h3>
          <p class="tg-card-desc">Современное искусство от местных авторов.</p>
          <span class="tg-card-time">Сегодня, 18:00</span>
        </div>
      </a>
    </section>

    <!-- Leaflet preview (CDN) -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <style>
      #index-map {
        height: 320px;
        border-radius: 8px;
        margin: 16px 0;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      }
      .map-preview h2 {
        margin: 12px 0 8px;
        font-size: 1.1rem;
      }
    </style>

    <script>
      (function () {
        try {
          var map = L.map("index-map", { scrollWheelZoom: false }).setView(
            [38.3452, -0.481],
            13
          );
          L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
            attribution: "© OpenStreetMap contributors",
          }).addTo(map);
          var sample = [
            { lat: 38.3452, lon: -0.481, title: "Ночной концерт" },
            { lat: 38.348, lon: -0.49, title: "Мастер‑класс по рисованию" },
            { lat: 38.341, lon: -0.475, title: "Арт‑выставка" },
          ];
          sample.forEach(function (s) {
            L.marker([s.lat, s.lon]).addTo(map).bindPopup(s.title);
          });
        } catch (e) {
          console.error("map preview error", e);
        }
      })();
    </script>

    <script src="../scripts/main.js"></script>
    <script src="script.js"></script>

    <!-- Leaflet preview (CDN) -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <style>
      #index-map {
        height: 320px;
        border-radius: 8px;
        margin: 16px 0;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      }
      .map-preview h2 {
        margin: 12px 0 8px;
        font-size: 1.1rem;
      }
    </style>

    <section class="map-preview">
      <h2>Карта — предпросмотр</h2>
      <div id="index-map"></div>
    </section>
    </section>

    <section class="calendar-section">
      <h2>Календарь событий</h2>
      <div id="calendar-container">
        <!-- Calendar component will be loaded here -->
        <p>Загрузка календаря...</p>
    <script>
    </section>

      (function () {
    <section class="contacts-section">
      <h2>Контакты</h2>
        try {
        <!-- Contacts component will be loaded here -->
        <p>Загрузка контактов...</p>
      </div>
    </section>
          var map = L.map("index-map", { scrollWheelZoom: false }).setView(
    <!-- Real-time Activity Section -->
    <section class="real-time-activity">
      <h2>Активность в реальном времени</h2>
      <div class="activity-stats">
        <div class="stat-item">
            [38.3452, -0.481],
          <span class="stat-label">активных пользователей</span>
        </div>
        <div class="stat-item">
          <span class="stat-number" id="events-today">0</span>
          <span class="stat-label">событий сегодня</span>
            13
        <div class="stat-item">
          );
          <span class="stat-label">новых контактов</span>
        </div>
      </div>
          L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
    </section>

            attribution: "© OpenStreetMap contributors",
      (function () {
        try {
          }).addTo(map);
            [38.3452, -0.481],
            13
          );
          L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
            attribution: "© OpenStreetMap contributors",
          var sample = [
          var sample = [
            { lat: 38.3452, lon: -0.481, title: "Ночной концерт" },
            { lat: 38.3452, lon: -0.481, title: "Ночной концерт" },
            { lat: 38.341, lon: -0.475, title: "Арт‑выставка" },
          ];
          sample.forEach(function (s) {
            { lat: 38.348, lon: -0.49, title: "Мастер‑класс по рисованию" },
          });
            { lat: 38.341, lon: -0.475, title: "Арт‑выставка" },
          console.error("map preview error", e);
          ];
      })();

      // Load real-time activity data
          sample.forEach(function (s) {
            L.marker([s.lat, s.lon]).addTo(map).bindPopup(s.title);
          .then(response => response.json())
          .then(events => {
          });
            const todayEvents = events.filter(event => {
              const eventDate = new Date(event.created_at).toDateString();
        } catch (e) {
            });

            document.getElementById('events-today').textContent = todayEvents.length;
            document.getElementById('active-users').textContent = Math.floor(Math.random() * 50) + 10; // Mock data
          console.error("map preview error", e);
          })
          .catch(err => console.error('Failed to load real-time stats:', err));
        }

      // Initialize real-time map
      function initRealTimeMap() {
        try {
          var rtMap = L.map("real-time-map", { scrollWheelZoom: false }).setView(
      })();
            13
          );
          L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
            attribution: "© OpenStreetMap contributors",
    </script>

          // Add real-time user location markers (mock data for now)
          setInterval(() => {
            // Clear existing markers and add new ones
            rtMap.eachLayer(function(layer) {
              if (layer instanceof L.Marker) {
                rtMap.removeLayer(layer);
              }
            });

            // Add mock user locations
            for (let i = 0; i < 5; i++) {
              const lat = 38.3452 + (Math.random() - 0.5) * 0.01;
              const lng = -0.481 + (Math.random() - 0.5) * 0.01;
              L.circleMarker([lat, lng], {
                color: '#007bff',
                radius: 8,
                fillOpacity: 0.6
              }).addTo(rtMap).bindPopup('Активный пользователь');
            }
          }, 5000); // Update every 5 seconds

        } catch (e) {
          console.error("real-time map error", e);
        }
      }

      // Initialize components when page loads
      document.addEventListener('DOMContentLoaded', function() {
        updateRealTimeStats();
        initRealTimeMap();

        // Update stats every 30 seconds
        setInterval(updateRealTimeStats, 30000);
      });
    </script>
  </body>
</html>
<html lang="ru">
